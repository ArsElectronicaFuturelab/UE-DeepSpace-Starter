;==============================================================================
; MozConfig.ini - MozXR Tracking System Configuration
;==============================================================================
;
; This configuration file defines the tracking setup for the MoxPharus plugin.
; It uses ONLY Unreal Engine vector formats for consistency and clarity.
;
; SUPPORTED FORMATS:
;   Vector3 (FVector):   PropertyName=(X=...,Y=...,Z=...)
;   Vector2D (FVector2D): PropertyName=(X=...,Y=...)
;   Rotator (FRotator):  PropertyName=(Pitch=...,Yaw=...,Roll=...)
;
; GLOBAL ORIGIN SYSTEM:
;   All tracking coordinates are now relative to a SINGLE 3D origin point.
;   Configure in [PharusSubsystem] as GlobalOrigin=(X=...,Y=...,Z=...)
;   OR place an AMoxPharusRootOriginActor in your level for dynamic control.
;
; WALL MAPPING (v2.1+):
;   Wall regions use CORNER-BASED anchoring:
;   - WorldPosition = Anchor point (bottom-left corner where (0,0) maps to)
;   - WorldRotation.Yaw = Direction wall runs (0°=+X, 90°=+Y, 180°=-X, 270°=-Y)
;   - Origin = Offset from anchor (usually 0,0 for corner-based mapping)
;
;==============================================================================

;METADATA=(Diff=true, UseCommands=true)

;==============================================================================
; GENERAL CONFIGURATION
;==============================================================================
; Preset metadata and versioning information
;==============================================================================

[General]
PresetName=Deep Space
Version=2.2.0
CreatedAt=2025-01-30 10:00:00
UpdatedAt=2025-12-17 09:30:00

;==============================================================================
; MoxAudio CONFIGURATION
;==============================================================================
; Audio system settings for MoxAudio integration with multi-target OSC broadcasting.
;
; === MULTI-TARGET OSC FLAGS ===
; oscGeneralEnabled:   Enable General OSC target (spatial audio, port 8000) - default: true
; oscAbletonEnabled:   Enable Ableton OSC target (music scenes, port 11000) - default: false
;
; NOTE: Multiple targets can be enabled simultaneously for multi-target broadcasting.
;       Commands will be sent to ALL enabled targets.
;
; === GENERAL OSC CONFIGURATION (Spatial Audio - Port 8000) ===
; autoStart:           Automatically start OSC sending on subsystem initialization (true/false)
; serverIP:            IP address of the General OSC server
; serverPort:          Port for General OSC data streaming
; updateRate:          OSC message send frequency in Hz (default: 30)
; continuousMode:      Position update mode (true/false)
;                      true  = Continuous streaming at updateRate (high bandwidth)
;                      false = Event-based (send only on change, default, recommended)
; origin:              Origin point for angle calculations in Unreal vector format (X,Y,Z in cm)
;
; === ABLETON OSC CONFIGURATION (Music Scenes - Port 11000) ===
; abletonIP:           IP address of Ableton Live (usually 127.0.0.1 for local)
; abletonPort:         Port for Ableton OSC control (default: 11000, AbletonOSC standard)
;
; === LOGGING CONFIGURATION ===
; logOSCMessages:      Log all OSC messages with full details (very verbose, debug only)
; logControlEvents:    Log playback control events (play/pause/stop/resume)
; logParameterEvents:  Log parameter change events (RTPC-style parameters)
; logPositionUpdates:  Log position/state updates (extremely verbose, debug only)
; logAbletonCommands:  Log Ableton-specific OSC commands
; logMultiTargetBroadcast: Log multi-target broadcasting details (shows target count)
; logBroadcastTimings: Log broadcast performance timings (milliseconds per target)
;==============================================================================

[moxaudio]
;------------------------------------------------------------------------------
; Multi-Target OSC Flags (Independent - can enable multiple simultaneously)
;------------------------------------------------------------------------------
oscGeneralEnabled=True
oscAbletonEnabled=True

;------------------------------------------------------------------------------
; General OSC Configuration (Spatial Audio - Port 8000)
;------------------------------------------------------------------------------
autoStart=False
# serverIP=192.168.101.34
serverIP=127.0.0.1
serverPort=8000
updateRate=10
continuousMode=False
origin=(X=700.0,Y=500.0,Z=0.0)

;------------------------------------------------------------------------------
; Ableton OSC Configuration (Music Scenes - Port 11000)
;------------------------------------------------------------------------------
abletonIP=127.0.0.1
abletonPort=11000

;------------------------------------------------------------------------------
; Logging Configuration
;------------------------------------------------------------------------------
logOSCMessages=False
logControlEvents=True
logParameterEvents=True
logPositionUpdates=False
logAbletonCommands=True
logMultiTargetBroadcast=False
logBroadcastTimings=False

;==============================================================================
; ABLETON LIVE INTEGRATION
;==============================================================================
; Ableton clip triggering is now configured directly in MoxAudioComponent!
;
; === HOW TO USE ===
;
; 1. Add MoxAudioComponent to your Actor in Blueprint
; 2. Set the following properties in the component:
;
;    SourceName: "gunshot"           ← Unique name for this sound
;    AbletonTrackID: 0               ← Ableton Track (0 = first track)
;    AbletonClipSlot: 0              ← Clip Slot (0 = first slot)
;
; 3. Call PlayAudio() on the component
;    → Fires the specified clip in Ableton Live
;
; === BENEFITS ===
;
; ✓ Simple: Configure directly in Blueprint/Level Editor
; ✓ Visual: See all settings in one place
; ✓ Flexible: Change at runtime, per-actor configuration
; ✓ No config files: Everything in the component properties
;
; === EXAMPLES ===
;
; Component 1 (Gunshot):
;   SourceName: "gunshot"
;   AbletonTrackID: 0
;   AbletonClipSlot: 0
;   → PlayAudio() fires Track 0, Slot 0
;
; Component 2 (Explosion):
;   SourceName: "explosion"
;   AbletonTrackID: 0
;   AbletonClipSlot: 1
;   → PlayAudio() fires Track 0, Slot 1
;
; Component 3 (Music):
;   SourceName: "music_combat"
;   AbletonTrackID: 1
;   AbletonClipSlot: 0
;   → PlayAudio() fires Track 1, Slot 0
;
; === ABLETON LIVE SETUP ===
;
; - Track 0: OneShot SFX (gunshot, explosion, footsteps, etc.)
; - Track 1: Music Layers (combat, ambient, boss, etc.)
; - Track 2: Ambient Sounds (wind, rain, birds, etc.)
; - Track 3+: Additional audio channels (up to 64+ tracks supported)
;
; === DIRECT CONTROL API ===
;
; Use these Blueprint functions for manual control:
;
; - Fire Ableton Clip (TrackID, ClipSlot)
; - Stop Ableton Clip (TrackID, ClipSlot)
; - Fire Ableton Scene (SceneID)
; - Stop Ableton Track (TrackID)
; - Set Ableton Track Volume (TrackID, Volume)
; - Set Ableton Track Mute (TrackID, bMute)
;
; All functions available in category: "MozXR|Audio|Ableton"
;==============================================================================


;==============================================================================
; OPTITRACK CONFIGURATION
;==============================================================================
; Motion capture system settings for OptiTrack integration.
;
; serverIP:      IP address of the OptiTrack server (Motive)
; serverPort:    Port for OptiTrack data streaming
; multicastIP:   Multicast group for data distribution
; clientIP:      Local client IP address
; useMulticast:  Enable multicast mode (true) or unicast (false)
; connectionType: Communication protocol (Unicast/Multicast)
;==============================================================================

[optitrack]
enable=false
serverIP=127.0.0.1
serverPort=1510
multicastIP=239.255.42.99
clientIP=127.0.0.1
useMulticast=true
connectionType=Unicast

;==============================================================================
; DEEPSYNC CONFIGURATION
;==============================================================================
; User synchronization settings for multi-user tracking.

;==============================================================================
[DeepSync]
;------------------------------------------------------------------------------
; Connection Configuration
;------------------------------------------------------------------------------
autoStart=false
deepSyncIp=127.0.0.1
deepSyncReceiverPort=43397
deepSyncSenderPort=43396
wearableLostTimeout=2.0

;------------------------------------------------------------------------------
; Logging Configuration
;------------------------------------------------------------------------------
; logWearableConnected: Log when new wearables connect
logWearableConnected=true

; logWearableLost: Log when wearables timeout/disconnect
logWearableLost=true

; logWearableUpdated: Log every wearable data update (WARNING: Very verbose!)
logWearableUpdated=false

; logHeartRateChanges: Log heart rate value changes
logHeartRateChanges=false

; logColorCommands: Log color commands sent to wearables
logColorCommands=true

; logConnectionStatus: Log connection status changes
logConnectionStatus=true

; logSyncEvents: Log Pharus sync zone events (link established/broken)
logSyncEvents=true




;==============================================================================
; PHARUS SUBSYSTEM CONFIGURATION
;==============================================================================
; Global settings for the MoxPharus tracking subsystem.
;
; DefaultInstance:      Primary tracking instance to use
; AutoCreateInstances:  Comma-separated list of instances to create at startup
;                       (Available: Wall, Floor)
;==============================================================================

[PharusSubsystem]
DefaultInstance=Floor
AutoCreateInstances=Floor
; AutoStartSystem: Controls if Pharus system starts automatically on initialization
; true = Auto-start (default, backward compatible)
; false = Manual start required via Blueprint/C++ call to StartPharusSystem()
AutoStartSystem=false
; Delay in seconds before auto-creating instances (ensures network is ready for nDisplay)
; Recommended: 0.5-5.0 seconds
AutoCreateDelay=0.5

;------------------------------------------------------------------------------
; Global Root Origin Configuration
;------------------------------------------------------------------------------
; GlobalOrigin: The 3D origin point used for ALL tracking instances (Floor + Wall)
; This replaces per-instance Origin settings for centralized coordinate management.
; Format: (X=...,Y=...,Z=...) in Unreal Engine centimeters
GlobalOrigin=(X=0.0,Y=0.0,Z=0.0)

; GlobalRotation: The 3D rotation applied to ALL tracking instances (Floor + Wall)
; Rotates the entire tracking coordinate system around the GlobalOrigin.
; Format: (Pitch=...,Yaw=...,Roll=...) in degrees
; Example: Yaw=90 rotates the tracking system 90° clockwise when viewed from above
GlobalRotation=(Pitch=0.0,Yaw=0.0,Roll=0.0)

; UsePharusRootOriginActor: Use a placed AMoxPharusRootOriginActor instead of GlobalOrigin/GlobalRotation
; true = Actor position AND rotation is used (dynamic - updates every frame)
; false = Use static GlobalOrigin/GlobalRotation from this config file (default)
;
; IMPORTANT: Dynamic root origin (=true) ONLY works with Pharus Subsystem!
;            LiveLink reads the origin ONCE at startup and does NOT update dynamically.
UsePharusRootOriginActor=true

; UseRelativeSpawning: When true AND UsePharusRootOriginActor=true, actors are attached
; as children to the RootOriginActor. This eliminates per-frame transform calculations
; when the origin moves (camera dolly, moving stage). Recommended for nDisplay setups.
UseRelativeSpawning=true

;==============================================================================
; FLOOR TRACKING INSTANCE
;==============================================================================
; Configuration for horizontal floor/ground tracking surface.
;
; COORDINATE SYSTEM:
; -----------------
; Simple mode with 2D coordinate transformation:
;   - Origin: Bottom-left corner of tracking surface
;   - X-axis: Horizontal (left → right)
;   - Y-axis: Vertical (bottom → top)
;   - FloorZ: Height offset in UE world space (cm)
;   - FloorRotation: 2D rotation applied to tracking coordinates (degrees)
;
; NORMALIZATION:
; -------------
; UseNormalizedCoordinates=true:  Simulator sends 0-1 coordinates
; UseNormalizedCoordinates=false: Simulator sends absolute meters, normalized
;                                 using TrackingSurfaceDimensions
;
; LIVELINK INTEGRATION:
; --------------------
; EnableLiveLink: Controls BOTH LiveLink subjects AND actor spawning
;   true  = Spawn actors in world + create LiveLink subjects
;   false = Only create LiveLink subjects, NO actors spawn (LiveLink-only mode)
; EnableSlotMapping=true: Maps track IDs to fixed slots (1-MaxSlots)
; ReuseLowestSlot=true: Reuses lowest available slot when tracks are lost
;
; NETWORK:
; -------
; BindNIC:       Network interface to bind (0.0.0.0 = all interfaces)
; UDPPort:       UDP port for receiving tracking data
; IsMulticast:   Enable multicast mode
; MulticastGroup: Multicast IP address (e.g., 239.1.1.1)
;==============================================================================

[Pharus.Floor]
;------------------------------------------------------------------------------
; Basic Settings
;------------------------------------------------------------------------------
Enable=true
MappingMode=Simple

;------------------------------------------------------------------------------
; Network Configuration
;------------------------------------------------------------------------------
BindNIC=0.0.0.0
; Alternative: Bind to specific interface
; BindNIC=192.168.101.60
; BindNIC=127.0.0.1
UDPPort=44345
IsMulticast=true
MulticastGroup=239.1.1.1

;------------------------------------------------------------------------------
; Actor Pool für nDisplay
;------------------------------------------------------------------------------
UseActorPool=false
ActorPoolSize=50

; Location where pooled actors spawn and rest when inactive (X,Y,Z in cm)
PoolSpawnLocation=(X=0.0,Y=0.0,Z=-1000.0)

; Rotation for pooled actors when inactive (Pitch,Yaw,Roll in degrees)
PoolSpawnRotation=(Pitch=0.0,Yaw=0.0,Roll=0.0)

; Offset each pooled actor by index to prevent visual clustering (X,Y,Z in cm)
PoolIndexOffset=(X=0.0,Y=10.0,Z=0.0)

;------------------------------------------------------------------------------
; Coordinate System Settings
;------------------------------------------------------------------------------
; NOTE: Origin is now GLOBAL via [PharusSubsystem].GlobalOrigin or
;       by placing an AMoxPharusRootOriginActor in your level!

; Scale factors for X/Y transformation - UE Vector2D format
; After normalization (0-1), this scales to final world size in cm
; For 12.2m x 13.5m tracking area: Scale = 1220cm x 1350cm
Scale=(X=1500.0,Y=830.0)

; Floor height offset from GlobalOrigin Z in UE world space (cm)
; This is a RELATIVE offset added to GlobalOrigin.Z
FloorZ=0.0

; 2D rotation applied to tracking coordinates (degrees, clockwise)
FloorRotation=90

; Invert Y-axis (flip top/bottom)
InvertY=true

;------------------------------------------------------------------------------
; Tracking Surface Configuration
;------------------------------------------------------------------------------
; Physical dimensions of tracking surface in meters - UE Vector2D format
; Used for normalizing absolute coordinates to 0-1 range
; IMPORTANT: Must match simulator dimensions (TrackLinkSimulator_UniCast_Floor: 12.2m x 13.5m)
TrackingSurfaceDimensions=(X=15.0,Y=8.3)

; Coordinate mode:
;   true  = Simulator sends normalized coordinates (0-1) - use directly
;   false = Simulator sends absolute world coordinates (meters) - normalize them
; NOTE: TrackLinkSimulator sends absolute meters, so we must normalize them
UseNormalizedCoordinates=true

;------------------------------------------------------------------------------
; LiveLink Integration (Optional)
;------------------------------------------------------------------------------
; EnableLiveLink: Controls BOTH LiveLink subjects AND actor spawning
;   true  = Spawn actors in world + create LiveLink subjects
;   false = Only create LiveLink subjects, NO actors spawn (LiveLink-only mode)
EnableLiveLink=true
EnableSlotMapping=true
MaxSlots=10
ReuseLowestSlot=true

;------------------------------------------------------------------------------
; Actor Spawning
;------------------------------------------------------------------------------
DefaultSpawnClass=/MoxPharus/Core/BP_Mox_PharusClusterFloorActor.BP_Mox_PharusClusterFloorActor_C

SpawnCollisionHandling=AlwaysSpawn
AutoDestroyOnTrackLost=true

; ApplyOrientationFromMovement: Auto-orient actors based on movement direction
; false = All actors have same rotation (RootRotation) - room rotates as a unit
; true = Each actor oriented by its movement direction (individual rotations)
ApplyOrientationFromMovement=true

;==============================================================================
; COMMON WALL SETTINGS
;==============================================================================
; Settings applied to all wall regions
;==============================================================================

;------------------------------------------------------------------------------
; Transform Mode
;------------------------------------------------------------------------------
; UseLocalSpace: Apply transformations in local vs world space
UseLocalSpace=false

; ApplyOrientationFromMovement: Auto-orient actors based on movement direction
; false = All actors have same rotation (RootRotation) - room rotates as a unit
; true = Each actor oriented by its movement direction (individual rotations)
ApplyOrientationFromMovement=false

;------------------------------------------------------------------------------
; Runtime Configuration
;------------------------------------------------------------------------------
; LiveAdjustments: Allow runtime configuration changes without restart
LiveAdjustments=true

; TrackLostTimeout: Seconds without UDP updates before track is treated as lost
;   Detects simulator crash/close vs. person standing still (0 = disabled)
TrackLostTimeout=3.0

;------------------------------------------------------------------------------
; Logging Configuration
;------------------------------------------------------------------------------
; LogTrackerSpawned: Log when new trackers are created
LogTrackerSpawned=true

; LogTrackerUpdated: Log every position update (WARNING: Very verbose!)
LogTrackerUpdated=false

; LogTrackerRemoved: Log when trackers are destroyed
LogTrackerRemoved=true

; LogNetworkStats: Log network performance statistics
LogNetworkStats=false

; LogRegionAssignment: Log wall region assignments
LogRegionAssignment=true

;------------------------------------------------------------------------------
; Debug Visualization
;------------------------------------------------------------------------------
; DebugDrawBounds: Draw tracking surface bounds
DebugDrawBounds=true

; DebugDrawWallPlanes: Draw wall plane visualizations
DebugDrawWallPlanes=true

; DebugDrawRegionBoundaries: Draw region boundary lines
DebugDrawRegionBoundaries=true
